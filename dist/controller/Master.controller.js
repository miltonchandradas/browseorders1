"use strict";function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);if(t)i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable});r.push.apply(r,i)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};if(t%2){ownKeys(Object(r),true).forEach(function(t){_defineProperty(e,t,r[t])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(r))}else{ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}}return e}function _defineProperty(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/Sorter","sap/m/GroupHeaderListItem","sap/ui/Device","sap/ui/core/Fragment","../model/formatter","sap/ui/core/format/DateFormat"],function(e,t,r,i,o,a,s,n,l,u){"use strict";return e.extend("sap.ui.demo.orderbrowser.controller.Master",{formatter:l,onInit:function e(){var t={firstName:"Milton",city:"Atlanta"};var r=["tennis","soccer","chess"];var i=_objectSpread(_objectSpread({},t),{},{lastName:"Chandradas",hobbies:r});console.log(i);var o=this.byId("list"),a=this._createViewModel(),s=o.getBusyIndicatorDelay();this._oGroupFunctions={CompanyName:function e(t){var r=t.getProperty("Customer/CompanyName");return{key:r,text:r}},OrderDate:function(e){var t=e.getProperty("OrderDate"),r=t.getFullYear(),i=t.getMonth()+1,o=this._oMonthNameFormat.format(t);return{key:r+"-"+i,text:this.getResourceBundle().getText("masterGroupTitleOrderedInPeriod",[o,r])}}.bind(this),ShippedDate:function(e){var t=e.getProperty("ShippedDate");if(t!=null){var r=t.getFullYear(),i=t.getMonth()+1,o=this._oMonthNameFormat.format(t);return{key:r+"-"+i,text:this.getResourceBundle().getText("masterGroupTitleShippedInPeriod",[o,r])}}else{return{key:0,text:this.getResourceBundle().getText("masterGroupTitleNotShippedYet")}}}.bind(this)};this._oMonthNameFormat=u.getInstance({pattern:"MMMM"});this._oList=o;this._oListFilterState={aFilter:[],aSearch:[]};this.setModel(a,"masterView");o.attachEventOnce("updateFinished",function(){a.setProperty("/delay",s)});this.getView().addEventDelegate({onBeforeFirstShow:function(){this.getOwnerComponent().oListSelector.setBoundMasterList(o)}.bind(this)});this.getRouter().getRoute("master").attachPatternMatched(this._onMasterMatched,this);this.getRouter().attachBypassed(this.onBypassed,this)},onUpdateFinished:function e(t){this._updateListItemCount(t.getParameter("total"))},onSearch:function e(t){if(t.getParameters().refreshButtonPressed){this.onRefresh();return}var o=t.getParameter("query");if(o){this._oListFilterState.aSearch=[new r("CustomerName",i.Contains,o)]}else{this._oListFilterState.aSearch=[]}this._applyFilterSearch()},onRefresh:function e(){this._oList.getBinding("items").refresh()},onOpenViewSettings:function e(t){var r="filter";if(t.getSource()instanceof sap.m.Button){var i=t.getSource().sId;if(i.match("sort")){r="sort"}else if(i.match("group")){r="group"}}if(!this.byId("viewSettingsDialog")){n.load({id:this.getView().getId(),name:"sap.ui.demo.orderbrowser.view.ViewSettingsDialog",controller:this}).then(function(e){this.getView().addDependent(e);e.addStyleClass(this.getOwnerComponent().getContentDensityClass());e.open(r)}.bind(this))}else{this.byId("viewSettingsDialog").open(r)}},onConfirmViewSettingsDialog:function e(t){var o=t.getParameter("filterItems"),a=[],s=[];o.forEach(function(e){switch(e.getKey()){case"Shipped":a.push(new r("ShippedDate",i.NE,null));break;case"NotShipped":a.push(new r("ShippedDate",i.EQ,null));break;default:break}s.push(e.getText())});this._oListFilterState.aFilter=a;this._updateFilterBar(s.join(", "));this._applyFilterSearch();this._applyGrouper(t)},_applyGrouper:function e(t){var r=t.getParameters(),i,a,s=[];if(r.groupItem){r.groupItem.getKey()==="CompanyName"?i="Customer/"+r.groupItem.getKey():i=r.groupItem.getKey();a=r.groupDescending;var n=this._oGroupFunctions[r.groupItem.getKey()];s.push(new o(i,a,n))}this._oList.getBinding("items").sort(s)},onSelectionChange:function e(t){var r=t.getSource(),i=t.getParameter("selected");if(!(r.getMode()==="MultiSelect"&&!i)){this._showDetail(t.getParameter("listItem")||t.getSource())}},onBypassed:function e(){this._oList.removeSelections(true)},createGroupHeader:function e(t){return new a({title:t.text,upperCase:false})},_createViewModel:function e(){return new t({isFilterBarVisible:false,filterBarLabel:"",delay:0,titleCount:0,noDataText:this.getResourceBundle().getText("masterListNoDataText")})},_onMasterMatched:function e(){this.getModel("appView").setProperty("/layout","OneColumn")},_showDetail:function e(t){var r=!s.system.phone;this.getModel("appView").setProperty("/layout","TwoColumnsMidExpanded");this.getRouter().navTo("object",{objectId:t.getBindingContext().getProperty("OrderID")},r)},_updateListItemCount:function e(t){if(this._oList.getBinding("items").isLengthFinal()){this.getModel("masterView").setProperty("/titleCount",t)}},_applyFilterSearch:function e(){var t=this._oListFilterState.aSearch.concat(this._oListFilterState.aFilter),r=this.getModel("masterView");this._oList.getBinding("items").filter(t,"Application");if(t.length!==0){r.setProperty("/noDataText",this.getResourceBundle().getText("masterListNoDataWithFilterOrSearchText"))}else if(this._oListFilterState.aSearch.length>0){r.setProperty("/noDataText",this.getResourceBundle().getText("masterListNoDataText"))}},_updateFilterBar:function e(t){var r=this.getModel("masterView");r.setProperty("/isFilterBarVisible",this._oListFilterState.aFilter.length>0);r.setProperty("/filterBarLabel",this.getResourceBundle().getText("masterFilterBarText",[t]))}})});